<main role="main" class="container user-panel-page">
    <div class="container">

        <div class="row">
            <div *ngIf="!isMobile()" class="col-xs-4 col-md-3 col-nav">
                <ul class="nav" *ngIf="customer && store.modality == 1">
                    <li class="user-info">
                        <span>Olá, <b>{{customer.firstname_Companyname}}</b></span>
                        <span class="mail">{{customer.email}}</span>
                        <a [routerLink]="['/logout']" class="btn-exit">Sair</a>
                    </li>
                    <li *ngFor="let module of modules" [ngClass]="{ 'active': (module.module == actual.module) }">
                        <a [routerLink]="['/conta/' + module.module]" (click)="open($event, module.module)">{{module.title}}</a>
                    </li>
                </ul>

                <ul class="nav" *ngIf="customer && store.modality == 0">
                    <li class="user-info">
                        <span>Olá, <b>{{customer.firstname_Companyname}}</b></span>
                        <span class="mail">{{customer.email}}</span>
                        <a [routerLink]="['/logout']" class="btn-exit">Sair</a>
                    </li>
                    <li [ngClass]="{ 'active': (actual.module == 'home') }">
                        <a [routerLink]="['/conta/home']" (click)="open($event, 'home')">Minhas Conta</a>
                    </li>
                    <li [ngClass]="{ 'active': (actual.module == 'dados-cadastrais') }">
                        <a [routerLink]="['/conta/dados-cadastrais']" (click)="open($event, 'dados-cadastrais')">Meus Dados Cadastrais</a>
                    </li>
                    <li [ngClass]="{ 'active': (actual.module == 'enderecos') }">
                        <a [routerLink]="['/conta/enderecos']" (click)="open($event, 'enderecos')">Meus Endereços</a>
                    </li>
                </ul>
            </div>
            <div class="col-md-9 col-sm-12 col-details">
                <loading-indicator [loading]="loading"></loading-indicator>
                <section *ngIf="actual.module == 'home'" class="col-sm-12">
                    <h2 class="title-my-account">Minha Conta</h2>

                    <div class="orders-box" *ngIf="lastOrder && store.modality == 1">
                        <h3>Seu pedido mais recente</h3>
                        <table class="table-order-vouchers">
                            <tbody>
                                <tr>
                                    <td class="col-details">
                                        <span>Nº do pedido:</span>
                                        <strong>{{lastOrder.orderNumber}}</strong>
                                        <span class="date">Realizado em: {{lastOrder.historyStatus[0].alterDate | date:'dd/MM/y'}} - {{lastOrder.historyStatus[0].alterDate | date:'H:m'}}</span>
                                    </td>
                                    <td class="col-status">
                                        <span>Status do Pedido</span>
                                        <strong class="status">{{lastOrder.labelStatus()}}</strong>
                                        <span *ngIf="lastOrder.status == 3" class="date">Entregue em: {{lastOrder.historyStatus[lastOrder.historyStatus.length - 1].alterDate | date:'dd/MM/y'}}</span>
                                    </td>
                                    <td class="col-total">
                                        <span>Valor Total</span>
                                        <strong>{{lastOrder.orderPrice | currencyFormat}}</strong>
                                    </td>
                                    <td class="col-actions text-center">
                                        <a [routerLink]="['/conta', 'pedidos', lastOrder.id]" class="btn btn-default btn-show-detail"><span class="visible-xs visible-sm"><i class="fa fa-eye" aria-hidden="true"></i></span><span class="visible-md visible-lg">VER DETALHES</span></a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <button class="btn btn-default btn-all-orders" (click)="open($event, 'pedidos')">VER TODOS OS PEDIDOS</button>
                    </div>

                    <div class="orders-box">
                        <div>
                            <h3>Meus Dados</h3>
                            
                            <b class="name">{{customer.firstname_Companyname}} {{customer.lastname_Tradingname}}</b>
                            <p>
                                {{(customer.type == 1) ? 'CPF' : 'CNPJ'}}: {{customer.cpf_Cnpj}} <br />
                                <span *ngIf="customer.type == 1">Sexo: {{(customer.gender == 'M') ? 'Masculino' : 'Feminino'}}</span> <br />
                                Data de Nascimento: {{customer.birthdate | date:'dd/MM/y'}} <br />
                                Telefone: {{customer.phone}}<br />
                                E-mail: {{customer.email}} <br />
                            </p>
                        </div>

                        <a class="btn btn-default btn-edit-account" [routerLink]="['/conta/dados-cadastrais']" (click)="open($event, 'dados-cadastrais')">EDITAR DADOS CADASTRAIS</a>
                    </div>

                    <div class="orders-box">
                        <h3>Meus Endereços</h3>
                        
                        <div class="row row-address">
                            <address-panel-list *ngFor="let address of customer.addresses" [address]="address"></address-panel-list>
                            
                        </div>
                        <div class="row">
                            <a class="btn btn-default btn-edit-account" [routerLink]="['/conta/enderecos']" (click)="open($event, 'enderecos')">EDITAR DADOS ENDEREÇOS</a>
                        </div>
                    </div>
                </section>
                <section *ngIf="actual.module == 'pedidos'">
                    <order-panel [tabId]="tabId"></order-panel>
                </section>
                <section *ngIf="actual.module == 'dados-cadastrais'">
                    <user-edit></user-edit>
                </section>
                <section *ngIf="actual.module == 'enderecos'">
                    <address-panel [tabId]="tabId"></address-panel>
                </section>
                <section *ngIf="actual.module == 'vounchers'">
                    <vouncher-panel></vouncher-panel>
                </section>
            </div>
        </div>
    </div>

</main>